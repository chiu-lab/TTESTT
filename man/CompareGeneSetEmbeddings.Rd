% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CompareGeneSetEmbeddings.R
\name{CompareGeneSetEmbeddings}
\alias{CompareGeneSetEmbeddings}
\title{Compare DEG vs. background cosine similarities across pathways/MOAs}
\usage{
CompareGeneSetEmbeddings(
  degs,
  bkgs = NULL,
  category = c("GOBP", "C2CP_all", "BIOCARTA", "KEGG", "PID", "REACTOME", "WP", "MOA",
    "Customized"),
  embedding_input = NULL
)
}
\arguments{
\item{degs}{Differentially expressed genes (DEGs). After intersecting with
the built-in set of 18K genes, the number of matched DEGs must be in \link{15, 500}.}

\item{bkgs}{Background gene symbols (optional). If
\code{NULL},  the built-in set of 18K genes is used.}

\item{category}{Select pathway/MOAs/customized categories to analyze
one of \code{"GOBP"}, \code{"C2CP_all"}, \code{"BIOCARTA"}, \code{"KEGG"},
\code{"PID"}, \code{"REACTOME"}, \code{"WP"}, \code{"MOA"}, or
\code{"Customized"} (case-insensitive).}

\item{embedding_input}{Numeric matrix or data frame containing pathway or term
embeddings (required when \code{category = "Customized"}). Rows represent terms,
columns represent embedding dimensions (length = 3072). Row names are used as term labels.}
}
\value{
A \link[tibble]{tibble} with one row per pathway/term:
\describe{
\item{\code{name}}{Pathway/term name}
\item{\code{p_value_MWN_one_tailed}}{One-tailed Wilcoxon p-value (DEGs > background)}
\item{\code{median_cosine_similarity_degs}}{Median similarity in DEGs}
\item{\code{median_cosine_similarity_bkgs}}{Median similarity in background}
\item{\code{diff_cosine_similarity.}}{Median(DEGs) - Median(Background)}
\item{\code{cliffs_delta}}{Cliff's delta effect size}
\item{\code{cliffs_delta_ci_95}}{95\% CI for Cliff's delta}
\item{\code{cliffs_delta_magnitude}}{Magnitude category}
\item{\code{top10_degs_with_highest_cosine_similarity}}{Top 10 DEGs with values}
}
}
\description{
For each pathway (or user-supplied term embedding), this function compares the
cosine similarity distribution of differentially expressed genes (DEGs) to that
of background genes and summarizes the statistical evidence for enrichment.

The function returns the one-tailed Wilcoxon rank-sum test p-value
(testing whether DEGs > background), median cosine similarities for DEGs
and background genes, their median difference, Cliffâ€™s delta with a 95\% confidence
interval, and the top 10 DEGs with the highest cosine similarity.
}
\details{
This implements the analysis used in the paper's applications (e.g., testing
pathway/MOA hypotheses for STING pathway and drug mechanisms). It supports
curated similarity matrices distributed with the package (GO BP, MSigDB C2
subcollections BIOCARTA/KEGG/PID/REACTOME/WP, and MOA) as well as a
"Customized" mode that accepts user-supplied pathway/term embeddings.
}
\examples{
\dontrun{
# Customized example with mock embeddings (no on-disk .Rdata needed)
load(system.file("examples","example.rdata",package = "DEGEmbedR"))
head(embed_mat)
length(degs)
res <- CompareGeneSetEmbeddings(
  degs = degs,
  category = "Customized",
  embedding_input = embed_mat
)
head(res)
}

}
\seealso{
\code{\link[stats]{wilcox.test}}, \code{\link[effsize]{cliff.delta}},
\code{\link[tibble]{tibble}}, \code{\link[stringr]{str_extract}}
}
\keyword{effect-size}
\keyword{embeddings}
\keyword{enrichment}
\keyword{similarity}
\keyword{statistics}
